<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SHOENIVERS</title>
  <link rel="stylesheet" href="index.css" />
  <!-- Icon chuáº©n -->
  <link rel="icon" type="image/png" href="public/assets/logo/android-chrome-512x512.png">

  <!-- Náº¿u muá»‘n há»— trá»£ iOS/Android -->
  <link rel="apple-touch-icon" href="public/assets/logo/apple-touch-icon.png">
  <meta name="theme-color" content="#ffffff">

</head>

<body>
  <header>
    <nav id="navbar" class="navbar">
      <div class="logo-container">
        <h1 class="logo">SHOENIVERS</h1>
        <p class="tagline">BETA ACCESS</p>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">Trang chá»§</a></li>
        <li><a href="#" id="cartBtn">ğŸ›’ Giá» hÃ ng (<span id="cartCount">0</span>)</a></li>
        <li><a href="checkout.html">Thanh toÃ¡n</a></li>
        <li><a id="navbarLogin" href="login.html">ÄÄƒng nháº­p</a></li>
        <li><a id="navbarLogout" href="#" style="display:none;">ÄÄƒng xuáº¥t</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="intro">
      <img src="public/assets/background.jpeg" alt="background">
      <div class="intro-content">
        <model-viewer src="public/assets/sport_shoe.glb" alt="Nike Air Force 1" camera-controls disable-zoom auto-rotate
          auto-rotate-delay="0" rotation-per-second="30deg" ar class="shoe-viewer">
        </model-viewer>
        <h2>THE UNIVERSE OF SHOE</h2>
        <p>Where the best quality shoes are waitingâ€”not just for your budget, but for your lifestyle, your comfort, and
          your confidence. Whether you're chasing dreams, walking through daily challenges, or simply stepping into a
          new day, our shoes are designed to support every journey aheadâ€”with style, durability, and affordability
          combined</p>
      </div>
      <div class="intro-button">
        <a href="login.html" style="text-decoration: none;"><button>ÄÄƒng nháº­p ngay</button></a>
      </div>
    </section>

    <section class="products">
      <h2>OUR HIGHLIGHT</h2>
      <div class="product-list" id="product-list"></div>
    </section>

    <!-- Modal chi tiáº¿t sáº£n pháº©m -->
    <div id="productModal" class="modal">
      <div class="modal-content">
        <img id="modalImage" src="" alt="">
        <div class="info">
          <h2 id="modalName"></h2>
          <p><strong>GiÃ¡:</strong> <span id="modalPrice"></span></p>
          <p><strong>HÃ£ng:</strong> <span id="modalBrand"></span></p>
          <p><strong>MÃ u sáº¯c:</strong> <span id="modalColor"></span></p>
          <p id="modalDesc"></p>
        </div>
        <div class="modal-button">
          <button id="btnAddCart" style="background-color: rgb(34, 34, 255)">ThÃªm vÃ o giá» hÃ ng</button>
          <button id="btnBuy" style="background-color: rgb(38, 152, 0);">Mua</button>
          <button id="btnCloseModal" onclick="closeModal()" style="background-color: rgb(152, 0, 0);">ÄÃ³ng</button>
        </div>
      </div>
    </div>

    <!-- Popup giá» hÃ ng -->
    <div id="cartPopup" class="cart-popup" aria-hidden="true">
      <h3>Giá» hÃ ng</h3>
      <ul id="cartItems"></ul>
      <p id="cartTotal"></p>
      <div class="cart-actions">
        <button id="clearCart">XÃ³a táº¥t cáº£</button>
        <button onclick="closeCart()">ÄÃ³ng</button>
      </div>
    </div>

    <section class="news">
      <h2>Tin tá»©c & BÃ¡o chÃ­</h2>
      <div class="news-list">
        <article class="news-item">
          <img src="public/assets/new1.jpg" alt="Tin 1">
          <h3>Shoenivers ra máº¯t bá»™ sÆ°u táº­p giÃ y thu Ä‘Ã´ng 2025 â€“ Äá»‰nh cao phong cÃ¡ch vÃ  sá»± thoáº£i mÃ¡i</h3>
          <p>Shoenivers chÃ­nh thá»©c giá»›i thiá»‡u bá»™ sÆ°u táº­p Thu ÄÃ´ng 2025, mang Ä‘áº¿n tráº£i nghiá»‡m má»›i cho nhá»¯ng tÃ­n Ä‘á»“
            sneaker. Vá»›i cáº£m há»©ng tá»« Ä‘Æ°á»ng phá»‘ New York vÃ  phong cÃ¡ch tá»‘i giáº£n chÃ¢u Ã‚u, má»—i Ä‘Ã´i giÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ
            vá»«a Ãªm Ã¡i, vá»«a thá»i trang, phÃ¹ há»£p tá»« Ä‘i lÃ m Ä‘áº¿n Ä‘i chÆ¡i.
            Äiá»ƒm Ä‘áº·c biá»‡t lÃ  toÃ n bá»™ giÃ y sá»­ dá»¥ng Ä‘áº¿ CloudStepâ„¢ Ä‘á»™c quyá»n giÃºp giáº£m sá»‘c tá»‘i Ä‘a khi di chuyá»ƒn. Bá»™ sÆ°u táº­p
            hiá»‡n Ä‘Ã£ cÃ³ máº·t trÃªn website vÃ  toÃ n bá»™ cá»­a hÃ ng Shoenivers, vá»›i nhiá»u Æ°u Ä‘Ã£i Ä‘áº·c biá»‡t cho khÃ¡ch Ä‘áº·t sá»›m.</p>
          <a href="https://vn.louisvuitton.com/vie-vn/magazine/articles/men-fall-winter-2025-show" target="_blank">Xem
            chi tiáº¿t</a>
        </article>

        <article class="news-item">
          <img src="public/assets/new2.jpg" alt="Tin 2">
          <h3>Shoenivers báº¯t tay vá»›i nghá»‡ sÄ© Viá»‡t ra máº¯t phiÃªn báº£n giá»›i háº¡n</h3>
          <p>Shoenivers vá»«a cÃ´ng bá»‘ há»£p tÃ¡c vá»›i nghá»‡ sÄ© Ä‘Æ°á»ng phá»‘ ná»•i tiáº¿ng KhoaLee Ä‘á»ƒ cho ra máº¯t dÃ²ng sneaker phiÃªn báº£n
            giá»›i háº¡n â€œUrban Canvasâ€. Má»—i Ä‘Ã´i giÃ y Ä‘Æ°á»£c váº½ thá»§ cÃ´ng tá»«ng chi tiáº¿t, biáº¿n chÃºng thÃ nh tÃ¡c pháº©m nghá»‡ thuáº­t
            cÃ³ thá»ƒ mang trÃªn chÃ¢n.
            Chá»‰ cÃ³ 200 Ä‘Ã´i trÃªn toÃ n quá»‘c, kÃ¨m chá»©ng nháº­n Ä‘á»™c quyá»n vÃ  chá»¯ kÃ½ cá»§a nghá»‡ sÄ©. Äá»£t má»Ÿ bÃ¡n online Ä‘áº§u tiÃªn Ä‘Ã£
            chÃ¡y hÃ ng trong 3 giá». Dá»± kiáº¿n Ä‘á»£t má»Ÿ bÃ¡n tiáº¿p theo sáº½ diá»…n ra vÃ o cuá»‘i thÃ¡ng nÃ y â€“ fan Ä‘á»«ng bá» lá»¡!</p>
          <a href="https://www.lofficielvietnam.com/art-design/10-tac-pham-nghe-thuat-duong-pho-an-tuong-tren-the-gioi"
            target="_blank">Xem chi tiáº¿t</a>
        </article>
      </div>
    </section>

    <footer>
      <p>&copy; 2025 SHOENIVERS | LiÃªn há»‡: shoenivers@gmail.com</p>
    </footer>

    <div id="userPopup" class="userpopup" aria-hidden="true">
      <div class="popup-content">
        <button id="closePopup" class="close-popup">&times;</button>
        <img id="popupAvatar" src="" alt="avatar" class="popup-avatar">
        <h3 id="popupName"></h3>
        <p id="popupEmail"></p>
        <input type="file" id="avatarInput" style="display:none">
      </div>
    </div>

  </main>

  <script>
    // SNAP SCROLLING
    let isScrolling = false;
    let currentSection = 0; // 0 = intro, 1 = products
    const sections = document.querySelectorAll("main section");

    window.addEventListener("wheel", (e) => {
      if (isScrolling) return;
      isScrolling = true;

      if (e.deltaY > 0) {
        // Scroll xuá»‘ng
        currentSection = Math.min(currentSection + 1, sections.length - 1);
      } else {
        // Scroll lÃªn
        currentSection = Math.max(currentSection - 1, 0);
      }

      window.scrollTo({
        top: sections[currentSection].offsetTop,
        behavior: "smooth"
      });

      setTimeout(() => {
        isScrolling = false;
      }, 100); // Khoáº£ng thá»i gian khÃ³a cuá»™n
    });


    // helper keys
    const USERS_KEY = 'users_list';
    const CURRENT_USER_KEY = 'current_user';

    // NAVBAR SCROLL EFFECT
    const navbar = document.getElementById('navbar');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) navbar.classList.add('scrolled'); else navbar.classList.remove('scrolled');
    });

    // PRODUCT SCROLL
    const slider = document.querySelector('.product-list');
    let isDown = false;
    let startX;
    let scrollLeft;

    slider.addEventListener('mousedown', (e) => {
      isDown = true;
      slider.classList.add('active');
      startX = e.pageX - slider.offsetLeft;
      scrollLeft = slider.scrollLeft;
    });

    slider.addEventListener('mouseleave', () => {
      isDown = false;
      slider.classList.remove('active');
    });

    slider.addEventListener('mouseup', () => {
      isDown = false;
      slider.classList.remove('active');
    });

    slider.addEventListener('mousemove', (e) => {
      if (!isDown) return; // Chá»‰ cháº¡y khi Ä‘ang giá»¯ chuá»™t
      e.preventDefault();
      const x = e.pageX - slider.offsetLeft;
      const walk = (x - startX) * 1.5; // tá»‘c Ä‘á»™ kÃ©o
      slider.scrollLeft = scrollLeft - walk;
    });


    // Render products data
    const products = [
      { id: 1, name: "Adidas Ultraboost", price: 3200000, brand: "Adidas", color: "Äen xÃ¡m", desc: "Thiáº¿t káº¿ hiá»‡n Ä‘áº¡i...", img: "public/assets/adidas_ultraboost.jpg", modal_img: "public/assets/adidas_ultraboost_modal.jpg" },
      { id: 2, name: "Nike Air Zoom", price: 2500000, brand: "Nike", color: "Tráº¯ng Ä‘en", desc: "GiÃ y cháº¡y bá»™ nháº¹...", img: "public/assets/nike_air_zoom.jpg", modal_img: "public/assets/nike_air_zoom_modal.jpg" },
      { id: 3, name: "Converse Classic", price: 1200000, brand: "Converse", color: "Tráº¯ng cá»• Ä‘iá»ƒn", desc: "Phong cÃ¡ch basic...", img: "public/assets/converse_classic.jpg", modal_img: "public/assets/converse_classic_modal.jpg" },
      { id: 4, name: "Vans Old Skool", price: 1500000, brand: "Vans", color: "Äen tráº¯ng", desc: "Cháº¥t liá»‡u canvas...", img: "public/assets/vans_oldskool.jpg", modal_img: "public/assets/vans_oldskool_modal.jpg" },
      { id: 5, name: "Puma RS-X", price: 2800000, brand: "Puma", color: "Xanh dÆ°Æ¡ng", desc: "Thiáº¿t káº¿ thá»ƒ thao...", img: "public/assets/puma_rsx.jpg", modal_img: "public/assets/puma_rsx_modal.jpg" },
      { id: 6, name: "New Balance 574", price: 2000000, brand: "New Balance", color: "XÃ¡m cá»• Ä‘iá»ƒn", desc: "Phong cÃ¡ch retro...", img: "public/assets/nb_574.jpg", modal_img: "public/assets/nb_574_modal.jpg" },
      { id: 7, name: "Reebok Classic", price: 1800000, brand: "Reebok", color: "Tráº¯ng Ä‘á»", desc: "Thiáº¿t káº¿ Ä‘Æ¡n giáº£n...", img: "public/assets/reebok_classic.jpg", modal_img: "public/assets/reebok_classic_modal.jpg" },
      { id: 8, name: "Asics Gel-Kayano", price: 3000000, brand: "Asics", color: "Xanh lÃ¡", desc: "GiÃ y cháº¡y bá»™ cao cáº¥p...", img: "public/assets/asics_gel_kayano.jpg", modal_img: "public/assets/asics_gel_kayano_modal.jpg" }
    ];

    const productList = document.getElementById("product-list");
    productList.innerHTML = '';
    products.forEach(p => {
      productList.innerHTML += `
        <div class="product-item">
          <img src="${p.img}" alt="${p.name}">
          <h3>${p.name}</h3>
          <p>GiÃ¡: ${p.price.toLocaleString()}Ä‘</p>
          <button onclick="openModal(${p.id})">Xem chi tiáº¿t</button>
        </div>
      `;
    });

    // Modal logic (single modal)
    function openModal(id) {
      const product = products.find(p => p.id === id);
      document.getElementById("modalImage").src = product.modal_img;
      document.getElementById("modalName").textContent = product.name;
      document.getElementById("modalPrice").textContent = product.price.toLocaleString() + "Ä‘";
      document.getElementById("modalBrand").textContent = product.brand;
      document.getElementById("modalColor").textContent = product.color;
      document.getElementById("modalDesc").textContent = product.desc;

      document.getElementById("btnAddCart").onclick = () => addCart(product.id);
      document.getElementById("btnBuy").onclick = () => alert("Mua " + product.name);

      document.getElementById("productModal").style.display = "flex";
    }
    function closeModal() { document.getElementById("productModal").style.display = "none"; }

    // USER: helpers
    function getUsers() { return JSON.parse(localStorage.getItem(USERS_KEY) || '[]'); }
    function saveUsers(u) { localStorage.setItem(USERS_KEY, JSON.stringify(u)); }
    function getCurrentUser() { return JSON.parse(localStorage.getItem(CURRENT_USER_KEY) || 'null'); }
    function setCurrentUser(u) { localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(u)); updateNavbar(); updateCartCount(); }

    // PROFILE POPUP
    function showProfilePopup(user) {
      if (!user) return;
      document.getElementById('popupAvatar').src = user.avatar || 'public/assets/default_avatar.jpg';
      document.getElementById('popupName').textContent = user.displayName || user.name || '';
      document.getElementById('popupEmail').textContent = user.username || user.email || '';
      document.getElementById('userPopup').style.display = 'block';
    }
    document.getElementById('closePopup').addEventListener('click', () => document.getElementById('userPopup').style.display = 'none');
    document.getElementById('popupAvatar').addEventListener('click', () => document.getElementById('avatarInput').click());
    document.getElementById('avatarInput').addEventListener('change', function () {
      const file = this.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function (e) {
        const newAvatar = e.target.result;
        let cur = getCurrentUser();
        if (!cur) return alert('Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ Ä‘á»•i avatar');
        cur.avatar = newAvatar;
        setCurrentUser(cur);
        // update users list
        let users = getUsers();
        users = users.map(u => (u.username === cur.username ? { ...u, avatar: newAvatar } : u));
        saveUsers(users);
        document.getElementById('popupAvatar').src = newAvatar;
      }
      reader.readAsDataURL(file);
    });

    // CART per-user
    function cartKeyForUser(username) { return `cart_${username}`; }
    function getCart() { const u = getCurrentUser(); if (!u) return []; return JSON.parse(localStorage.getItem(cartKeyForUser(u.username)) || '[]'); }
    function saveCart(cart) { const u = getCurrentUser(); if (!u) return; localStorage.setItem(cartKeyForUser(u.username), JSON.stringify(cart)); updateCartCount(); }

    function addCart(id) {
      const user = getCurrentUser();
      if (!user) { alert('Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ thÃªm sáº£n pháº©m.'); window.location.href = 'login.html'; return; }
      let cart = getCart();
      const product = products.find(p => p.id === id);
      // increase qty if exists
      const exist = cart.find(i => i.id === id);
      if (exist) { exist.qty = (exist.qty || 1) + 1; } else { cart.push({ id: product.id, name: product.name, price: product.price, qty: 1, img: product.img }); }
      saveCart(cart);
      alert('ÄÃ£ thÃªm ' + product.name + ' vÃ o giá» hÃ ng!');
      renderCartPopup();
    }

    function renderCartPopup() {
      const cart = getCart();
      const list = document.getElementById('cartItems');
      list.innerHTML = '';
      let total = 0;
      if (cart.length === 0) { list.innerHTML = '<li>Giá» hÃ ng trá»‘ng</li>'; document.getElementById('cartTotal').textContent = ''; return; }
      cart.forEach((it, idx) => {
        total += it.price * (it.qty || 1);
        list.innerHTML += `<li>
          <img src="${it.img}" alt="" style="width:46px;height:46px;object-fit:cover;border-radius:6px;margin-right:8px;vertical-align:middle;">
          ${it.name} <b>${(it.price).toLocaleString()}Ä‘</b> x ${it.qty || 1}
          <button onclick="removeFromCart(${idx})" style="float:right">X</button>
        </li>`;
      });
      document.getElementById('cartTotal').textContent = 'Tá»•ng: ' + total.toLocaleString() + 'Ä‘';
    }

    function removeFromCart(index) {
      let cart = getCart();
      if (index < 0 || index >= cart.length) return;
      cart.splice(index, 1);
      saveCart(cart);
      renderCartPopup();
    }

    function clearCart() {
      const cur = getCurrentUser();
      if (!cur) return;
      localStorage.removeItem(cartKeyForUser(cur.username));
      renderCartPopup();
      updateCartCount();
    }

    function showCart() { renderCartPopup(); document.getElementById('cartPopup').style.display = 'block'; }
    function closeCart() { document.getElementById('cartPopup').style.display = 'none'; }

    // update cart count in navbar
    function updateCartCount() {
      const cur = getCurrentUser();
      const el = document.getElementById('cartCount');
      if (!cur) { el.textContent = '0'; return; }
      const cart = getCart();
      const count = cart.reduce((s, i) => s + (i.qty || 1), 0);
      el.textContent = count;
    }

    // toggle cart popup
    document.getElementById('cartBtn').addEventListener('click', (e) => {
      e.preventDefault();
      const popup = document.getElementById('cartPopup');
      if (popup.style.display === 'block') { closeCart(); } else { showCart(); }
    });

    // update navbar if logged in
    function updateNavbar() {
      const cur = getCurrentUser();
      const navbarLogin = document.getElementById('navbarLogin');
      const introBtn = document.querySelector('.intro-button');
      let logoutLink = document.getElementById('navbarLogout');

      if (cur) {
        // áº¨n intro button
        if (introBtn) introBtn.style.display = 'none';

        // Cáº­p nháº­t nÃºt login thÃ nh avatar + tÃªn
        navbarLogin.innerHTML = `
      <img src="${cur.avatar || 'public/assets/default_avatar.jpg'}"
           class="nav-avatar"
           style="width:24px;height:24px;border-radius:50%;margin-right:6px;vertical-align:middle;">
      ${cur.displayName || cur.name}
    `;
        navbarLogin.href = '#';
        navbarLogin.onclick = (e) => { e.preventDefault(); showProfilePopup(cur); };

        // Náº¿u chÆ°a cÃ³ nÃºt logout thÃ¬ táº¡o
        if (!logoutLink) {
          logoutLink = document.createElement('li');
          logoutLink.innerHTML = `<a href="#" id="navbarLogout">ÄÄƒng xuáº¥t</a>`;
          document.querySelector('.nav-links').appendChild(logoutLink);
        }
        if (logoutLink.style.display === 'none') {
          logoutLink.style.display = '';
        }

        // GÃ¡n sá»± kiá»‡n logout
        document.getElementById('navbarLogout').onclick = (e) => {
          e.preventDefault();
          logoutUser(); // HÃ m xÃ³a user khá»i localStorage/session
          updateNavbar();
        };

      } else {
        // Hiá»‡n intro button láº¡i
        if (introBtn) introBtn.style.display = '';

        // Cáº­p nháº­t láº¡i nÃºt login
        navbarLogin.textContent = 'ÄÄƒng nháº­p';
        navbarLogin.href = 'login.html';
        navbarLogin.onclick = null;

        // XÃ³a nÃºt logout náº¿u cÃ³
        if (logoutLink) logoutLink.remove();
      }
    }
    // LOGOUT USER
    function logoutUser() {
      // XÃ³a thÃ´ng tin user khá»i localStorage
      localStorage.removeItem('current_user');

      // Náº¿u muá»‘n xÃ³a luÃ´n sessionStorage
      sessionStorage.removeItem('current_user');

      // (TÃ¹y chá»n) ThÃ´ng bÃ¡o
      console.log('ÄÃ£ Ä‘Äƒng xuáº¥t');

      // Náº¿u muá»‘n chuyá»ƒn vá» trang chá»§ sau khi Ä‘Äƒng xuáº¥t
      // window.location.href = '/';
    }


    //if user logined, the intro-button is hide
    document.addEventListener("DOMContentLoaded", () => {
      const user = getCurrentUser();
      const introBtn = document.querySelector(".intro-button");

      if (user && introBtn) {
        introBtn.style.display = "none";
      }
    });


    // init
    updateNavbar();
    updateCartCount();

  </script>

  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</body>

</html>